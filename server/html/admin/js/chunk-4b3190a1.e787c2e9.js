(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b3190a1"],{8629:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v("商品管理")]),r("div",[r("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"商品列表",name:"list"}},[r("div",[r("el-table",{staticStyle:{width:"90%"},attrs:{data:e.goods_list,height:"700px"}},[r("el-table-column",{attrs:{prop:"type.name",label:"商品分类",sortable:"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.type.name)+" ")]}}])}),r("el-table-column",{attrs:{prop:"name",label:"商品名称",sortable:"",width:"240"}}),r("el-table-column",{attrs:{prop:"price",label:"价格",width:"120"}}),r("el-table-column",{attrs:{prop:"sort",label:"排序",sortable:"",width:"100"}}),r("el-table-column",{attrs:{prop:"kamiType",label:"卡密类型",sortable:"",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.kamiType?r("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("默认卡密")]):e._e(),2===t.row.kamiType?r("el-tag",{attrs:{size:"mini",type:"warning"}},[e._v("循环卡密")]):e._e(),3===t.row.kamiType?r("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v("重复卡密")]):e._e()]}}])}),r("el-table-column",{attrs:{prop:"active",sortable:"",label:"状态",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.active?r("el-tag",{attrs:{size:"mini",type:"success"}},[e._v("激活")]):0===t.row.active?r("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("未激活")]):e._e()]}}])}),r("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(r){return e.handleActive(t.row)}}},[e._v("激活切换")]),r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(r){return e.handleEdit(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(r){return e.handleDel(t.row)}}},[e._v("删除")])]}}])})],1)],1)]),r("el-tab-pane",{attrs:{label:"添加商品",name:"add"}},[r("div",{staticClass:"goods_2"},[r("el-form",{ref:"formgoods",attrs:{model:e.formgoods,"label-width":"120px",rules:e.rules}},[r("el-form-item",{attrs:{label:"商品分类",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.formgoods.type,callback:function(t){e.$set(e.formgoods,"type",t)},expression:"formgoods.type"}},e._l(e.options,(function(e){return r("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1),r("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"5-20个字符",size:"mini",maxlength:"20","show-word-limit":""},model:{value:e.formgoods.name,callback:function(t){e.$set(e.formgoods,"name",t)},expression:"formgoods.name"}})],1),r("el-form-item",{attrs:{label:"商品图片:不小于300*300,正方形,1M以下"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,headers:e.getAuthHeaders(),"show-file-list":!1,"on-success":e.uploadsSuccess,"before-upload":e.beforeAvatarUpload}},[e.formgoods.goods_img?r("img",{staticClass:"avatar",attrs:{src:e.goods_img}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"排序",prop:"sort"}},[r("el-input",{attrs:{size:"mini"},model:{value:e.formgoods.sort,callback:function(t){e.$set(e.formgoods,"sort",e._n(t))},expression:"formgoods.sort"}})],1),r("el-form-item",{attrs:{label:"价格",prop:"price"}},[r("el-input",{attrs:{placeholder:"",size:"mini"},model:{value:e.formgoods.price,callback:function(t){e.$set(e.formgoods,"price",t)},expression:"formgoods.price"}},[r("template",{slot:"append"},[r("span",{staticStyle:{"font-weight":"bold",color:"orange"}},[e._v("￥"+e._s(Number(e.formgoods.price))+"元")])])],2)],1),r("el-form-item",{attrs:{label:"卡密类型",prop:"kamiType"}},[r("el-radio-group",{attrs:{size:"mini"},model:{value:e.formgoods.kamiType,callback:function(t){e.$set(e.formgoods,"kamiType",e._n(t))},expression:"formgoods.kamiType"}},[r("el-radio-button",{attrs:{label:"1"}},[e._v("默认卡密")]),r("el-radio-button",{attrs:{label:"2",disabled:""}},[e._v("循环卡密")]),r("el-radio-button",{attrs:{label:"3",disabled:""}},[e._v("重复卡密")])],1)],1),r("el-form-item",{attrs:{label:"商品描述",prop:"description"}},[r("el-input",{attrs:{type:"textarea",rows:2,maxlength:"1000","show-word-limit":"",placeholder:"必填，商品描述会在买家选择商品时展示，建议写上您商品的简介，官网以及常见的问题"},model:{value:e.formgoods.description,callback:function(t){e.$set(e.formgoods,"description",t)},expression:"formgoods.description"}})],1),r("el-form-item",{attrs:{label:"使用说明",prop:"Instructions"}},[r("el-input",{attrs:{type:"textarea",rows:2,maxlength:"1000","show-word-limit":"",placeholder:"必填，商品使用说明会在买家购买完成后展示，建议写上您的产品使用说明，售后联系方式等"},model:{value:e.formgoods.Instructions,callback:function(t){e.$set(e.formgoods,"Instructions",t)},expression:"formgoods.Instructions"}})],1),r("el-form-item",{attrs:{label:"是否激活",prop:"active"}},[r("el-radio-group",{attrs:{size:"mini"},model:{value:e.formgoods.active,callback:function(t){e.$set(e.formgoods,"active",e._n(t))},expression:"formgoods.active"}},[r("el-radio-button",{attrs:{label:"1"}},[e._v("激活")]),r("el-radio-button",{attrs:{label:"0"}},[e._v("不激活")])],1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.onSubmit}},[e._v("立即创建")]),r("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.$refs["formgoods"].resetFields()}}},[e._v("取消")])],1)],1)],1)])],1)],1),r("el-dialog",{attrs:{title:"商品编辑",visible:e.show_edit},on:{"update:visible":function(t){e.show_edit=t}}},[r("el-form",{ref:"edit_goods",attrs:{model:e.edit_goods,size:"small",rules:e.rulesA}},[r("el-form-item",{attrs:{label:"商品名称","label-width":"120px",prop:"name"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.edit_goods.name,callback:function(t){e.$set(e.edit_goods,"name",t)},expression:"edit_goods.name"}})],1),r("el-form-item",{attrs:{label:"商品价格","label-width":"120px",prop:"price"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.edit_goods.price,callback:function(t){e.$set(e.edit_goods,"price",t)},expression:"edit_goods.price"}})],1),r("el-form-item",{attrs:{label:"商品排序","label-width":"120px",prop:"sort"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.edit_goods.sort,callback:function(t){e.$set(e.edit_goods,"sort",e._n(t))},expression:"edit_goods.sort"}})],1),r("el-form-item",{attrs:{label:"商品描述",prop:"description"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"必填，商品描述会在买家选择商品时展示，建议写上您商品的简介，官网以及常见的问题"},model:{value:e.edit_goods.description,callback:function(t){e.$set(e.edit_goods,"description",t)},expression:"edit_goods.description"}})],1),r("el-form-item",{attrs:{label:"使用说明",prop:"Instructions"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"必填，商品使用说明会在买家购买完成后展示，建议写上您的产品使用说明，售后联系方式等"},model:{value:e.edit_goods.Instructions,callback:function(t){e.$set(e.edit_goods,"Instructions",t)},expression:"edit_goods.Instructions"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.show_edit=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.eidt_yes}},[e._v("确认已支付")])],1)],1)],1)},s=[],a=(r("a4d3"),r("4de4"),r("4160"),r("4e82"),r("a9e3"),r("1d1c"),r("7a82"),r("e439"),r("dbb4"),r("b64b"),r("d3b7"),r("159b"),r("2fa7"));r("96cf");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(r,!0).forEach((function(t){Object(a["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l={data:function(){var e=function(e,t,r){""===t||0===t?r(new Error("请输入价格")):/^\d{1,}(\.\d{1,}){0,1}$/.test(t)?r():r(new Error("请输入正确价格"))};return{goods_list:[],activeName:"list",formgoods:{sort:15,price:0,kamiType:1,active:1},options:[],edit_goods:{},show_edit:!1,rules:{type:[{required:!0,message:"请选择类型",trigger:"change"}],name:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:5,max:20,message:"长度在 5 到 20 个字符",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"},{validator:e,trigger:"change"}],description:[{required:!0,message:"请输入商品介绍",trigger:"blur"},{min:5,max:1e3,message:"长度在 5 到 1000 个字符",trigger:"blur"}],Instructions:[{required:!0,message:"请输入商品使用说明",trigger:"blur"},{min:5,max:1e3,message:"长度在 5 到 1000 个字符",trigger:"blur"}],active:[{required:!0,message:"请选择是否激活使用",trigger:"blur"}]},rulesA:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:5,max:20,message:"长度在 5 到 20 个字符",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"},{validator:e,trigger:"change"}],description:[{required:!0,message:"请输入商品介绍",trigger:"blur"},{min:5,max:1e3,message:"长度在 5 到 1000 个字符",trigger:"blur"}],Instructions:[{required:!0,message:"请输入商品使用说明",trigger:"blur"},{min:5,max:1e3,message:"长度在 5 到 1000 个字符",trigger:"blur"}]}}},computed:{goods_img:function(){return"https://fakaapi.idaay.com"+this.formgoods.goods_img}},created:function(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:this.fetch(),this.get_goods();case 2:case"end":return e.stop()}}),null,this)},methods:{handleClick:function(e,t){},handleActive:function(e){var t;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.$http.post("/goods/api/active_goods",e));case 2:t=r.sent,1===t.data.code&&(this.get_goods(),this.$message({type:"success",message:"切换成功"}));case 4:case"end":return r.stop()}}),null,this)},handleEdit:function(e){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.edit_goods=n({},e),this.show_edit=!0;case 2:case"end":return t.stop()}}),null,this)},eidt_yes:function(){var e=this;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.$refs["edit_goods"].validate((function(t){var r;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:if(t){o.next=4;break}e.$message({type:"error",message:"请检查商品各项目,填 写 完 整"}),o.next=9;break;case 4:return e.edit_goods.price=Number(e.edit_goods.price),o.next=7,regeneratorRuntime.awrap(e.$http.post("/goods/api/edit_goods",e.edit_goods));case 7:r=o.sent,1===r.data.code&&(e.$message({type:"success",message:"保存商品成功"}),e.get_goods(),e.show_edit=!1);case 9:case"end":return o.stop()}}))}));case 1:case"end":return t.stop()}}),null,this)},handleDel:function(e){var t;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.$http.post("/goods/api/del_goods",e));case 2:t=r.sent,1===t.data.code&&(this.get_goods(),this.$message({type:"success",message:"删除商品成功"}));case 4:case"end":return r.stop()}}),null,this)},onSubmit:function(){var e=this;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.$refs["formgoods"].validate((function(t){var r;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:if(t){o.next=4;break}e.$message({type:"error",message:"请检查商品各项目,填 写 完 整"}),o.next=8;break;case 4:return o.next=6,regeneratorRuntime.awrap(e.$http.post("/goods/api/add_goods",e.formgoods));case 6:r=o.sent,1===r.data.code?(e.$message({type:"success",message:"商品增加成功"}),e.get_goods(),e.activeName="list",e.$refs["formgoods"].resetFields()):0===r.data.code&&e.$message({type:"error",message:r.data.error});case 8:case"end":return o.stop()}}))}));case 1:case"end":return t.stop()}}),null,this)},fetch:function(){var e,t;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.$http.post("/goods/api/get_types"));case 2:e=r.sent,t=e.data.data.filter((function(e){return 1===e.active})),t.sort((function(e,t){return e.sort-t.sort})),this.options=t;case 6:case"end":return r.stop()}}),null,this)},get_goods:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.$http.post("/goods/api/get_goods"));case 2:e=t.sent,this.goods_list=e.data.data;case 4:case"end":return t.stop()}}),null,this)},beforeAvatarUpload:function(e){console.log(e);var t="image/jpeg"===e.type||"image/png"===e.type,r=e.size/1024/1024<1;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&r},uploadsSuccess:function(e){console.log(e),this.$set(this.formgoods,"goods_img",e.url)}}},c=l,d=(r("8824"),r("2877")),u=Object(d["a"])(c,o,s,!1,null,null,null);t["default"]=u.exports},8824:function(e,t,r){"use strict";var o=r("e2d6"),s=r.n(o);s.a},e2d6:function(e,t,r){}}]);